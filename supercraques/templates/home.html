<%inherit file="/base_logado.html"/>

<%def name="css()">
    ${parent.css()}
    <link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="/media/css/cards.css" />
</%def>


<%def name="javascript()">
    ${parent.javascript()}
    
    
    <script type="text/javascript" src="/media/js/supercraques.barra.js"></script>
    
    <script type="text/javascript"><!--
	$(function() {	

        //bind dos botoes do social
        $(".share-button a").mediaShare();
        
        var $dialog_atletas_card = $("#dialog-atletas-card");
        var $atletaCardTemplate = $("#atletaCardTemplate");
        var $contentDialogAtletaCard = $("#contentDialogAtletaCard");
        
        // criar o popin dos meus cards
        $dialog_atletas_card.dialog({autoOpen: false, height: 400, width: 800, modal: true});

        var barra = $("#supercraque-rodape").barra({}, false);
        barra.load();
        
        $(".aceitarDesafioCard").live("click", function() {
            $("#card_id_selecionado", $dialog_atletas_card).val($(this).attr("data"));
            $('#formDesafio', $dialog_atletas_card).submit();
        });
        
        // 
        $(".desafioCard").live("click", function() {
            var $elem = $(this);
            $.ajax({
                url: "/atletas_card.json",
                success: function(data) {
                  $("#desafio_id", $dialog_atletas_card).val($elem.attr("data"));
                  $contentDialogAtletaCard.html("");
                  $atletaCardTemplate.tmpl( data ).appendTo($contentDialogAtletaCard);
                  $dialog_atletas_card.dialog('open');
                },
                error:function(x,e) {
                  alert("error:" + e);
                }
              });
        });


        // buscar e exibe os desafios recebidos
        var $boxDesafiosRecebidosTemplate = $("#box-desafios-recebidos-template");
        var $boxDesafiosRecebidos = $("#box-desafios-recebidos");
        $.ajax({
            url: "/desafio/recebidos.json",
            success: function(result) {
                $boxDesafiosRecebidosTemplate.tmpl( result.data ).appendTo($boxDesafiosRecebidos);
            },
            error:function(x,e) {
              alert("error:" + e);
            }
        });

        // buscar e exibe os desafios enviados
        var $boxDesafiosEnviadosTemplate = $("#box-desafios-enviados-template");
        var $boxDesafiosEnviados = $("#box-desafios-enviados");
        $.ajax({
            url: "/desafio/enviados.json",
            success: function(result) {
                $boxDesafiosEnviadosTemplate.tmpl( result.data ).appendTo($boxDesafiosEnviados);
            },
            error:function(x,e) {
              alert("error:" + e);
            }
        });
            
        
	});
		
	--></script>
    
</%def>



<%def name="content()">
	<div class="glb-bloco">
		<BR>
		<!-- %include file="/box/box_usuario_info.html"/-->
	</div>

<BR>DESAFIOS<BR>

<div class="box-desafios-recebidos" id="box-desafios-recebidos"></div>
<div class="box-desafios-enviados" id="box-desafios-enviados"></div>


<div id="dialog-atletas-card" title="Meus Cards" style="display:none">
    <form action="/desafio/aceitar" method="POST" id="formDesafio">
        <input type="hidden" value="" id="desafio_id" name="desafio_id" />
        <input type="hidden" value="" id="card_id_selecionado" name="card_id_selecionado" />
        <div id="contentDialogAtletaCard"></div>
    </form>
</div>

<script id="atletaCardTemplate" type="text/x-jquery-tmpl">
    <div class="atletaCard">
        <img height="60" width="60" border="0" src="{{= img}}">
        <BR>
        <div class="player">Nome: {{= nome}}</div>
        <div class="position">Posicao: {{= posicao}}</div>
        <input type="radio" name="radio" value="qualidade" /> Qualidade: {{= qualidade}}<BR>
        <input type="radio" name="radio" value="assiduidade" /> Assiduidade: {{= assiduidade}}<BR>
        <input type="radio" name="radio" value="disciplina" /> Disciplina: {{= disciplina}}<BR>
        <a class="featured aceitarDesafioCard" data="{{= card_id}}">Jogar</a>
    </div>
</script> 

<script id="box-desafios-enviados-template" type="text/x-jquery-tmpl">
  <div class="box-card">
      <div class="info-time">
      <img border="0" src="https://graph.facebook.com/{{= usuario_desafiou_id}}/picture">X
      <img border="0" src="https://graph.facebook.com/{{= usuario_desafiado_id}}/picture">
      </div>
      <div class='share-button'>
        <img src="/media/img/social_div.gif" /> <a href='javascript:void(0)' class='facebook' data-text="Provoque seu amigo no eoneoenoeneo facebook" data-url="http://www.supercraques.com.br/" data-url-name="chico" title='Provoque seu amigo no Facebook'><img src="/media/img/facebook_ico.gif" alt='Provoque seu amigo' /></a>
        Provoque seu amigo!
      </div>        
  </div>
</script> 

<script id="box-desafios-recebidos-template" type="text/x-jquery-tmpl">
  <div class="box-card">
    <img border="0" src="https://graph.facebook.com/{{= usuario_desafiou_id}}/picture"> desafiou vc! 
    <a title="Click para escolher seu card!" class="featured desafioCard" data="{{= id}}">Escolha seu card!</a>
  </div>
</script> 


</%def>

