<%inherit file="/base_logado.html"/>

<%def name="css()">
    ${parent.css()}
    <link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="/media/css/cards.css" />
</%def>


<%def name="javascript()">
    ${parent.javascript()}
    
	<script type="text/javascript" src="/media/js/jquery.flip.min.js"></script>
    
    <script type="text/javascript"><!--
	$(function() {	
		
		// Vai para o primeiro option do combo de servicos
		$("#equipes option:first").attr("selected", "selected");
		
		$('.btn_comprar').live("click",function(){
        var $elem = $(this);
        $.ajax({
            url: "/atleta/"+ $elem.attr("atleta_id") + "/comprar",
            success: function(data) {
              alert(data.sucesso + " - " + data.message);
              // $elem.hide();
            },
            error:function(x,e) {
              alert("errosr:" + e);
            }
          });
		});
		
		$('.sponsorFlip').live("click",function(){
			var elem = $(this);
			if(elem.data('flipped'))
			{
				elem.revertFlip();
				elem.data('flipped',false)
			}
			else
			{
				elem.flip({
					direction:'lr',
					speed: 350,
					onBefore: function(){
						elem.html(elem.siblings('.sponsorData').html());
					}
				});
				elem.data('flipped',true);
			}
		});
	
		
		var $contenTemplate = $("#content-template");
		var $cardTemplate = $("#cardTemplate");
		var $contenLoading = $("#content-loading");
		
		// Carrega os jogadores do time escolhido
		$("#equipes").bind('change keyup', function() {
  			equipe_id = $(this).val()
  			if (equipe_id != "") {
				   $contenTemplate.html("");
  			   $contenLoading.show();
           $.ajax({
  					  url: "/equipe/"+ equipe_id + "/atletas.json",
  					  success: function(data) {
  					      $contenLoading.hide();
                  $cardTemplate.tmpl( data ).appendTo($contenTemplate);
  					  },
  					  error:function(x,e) {
  					      $contenLoading.hide();
  						    alert(data);
  					  }
  					});
  			} else {
  			  $contenLoading.hide();
  			  $contenTemplate.html("");
  			}
		});
		
	});
		
	--></script>
    
</%def>



<%def name="content()">

	<form class="form-filtro" action="" method="post">
		<fieldset>
	    <legend>filtro de jogadores</legend>
	    <select id="equipes" name="equipes">
	        <option value="">Time</option>
    			% for equipe in equipes:
    				<option value="${equipe['equipe_id']}">${equipe['nome_popular']}</option>
    			% endfor
	        </select>
	    </fieldset>
	</form>
	
	<div class="conteudo-jogadores">
		<div id="jogadores-lista" class="conteudo-jogadores-lista">
	    	<div id="content-template"></div>
	    	<div id="content-loading" class="ui-autocomplete-desafio-loading" style="display:none;height:100px;"></div>
		</div>
	</div> 

<script id="cardTemplate" type="text/x-jquery-tmpl">
    <div class="sponsor" title="Click to flip">
      <div class="sponsorFlip">
        <img height="60" width="60" border="0" src="{{= img}}">
        <BR>
        <div class="player">Nome: {{= nome}}</div>
        <div class="position">Posicao: {{= posicao}}</div>
        <div class="num">Qualidade: {{= qualidade}}</div>
        <div class="num">Assiduidade: {{= assiduidade}}</div>
        <div class="num">Disciplina: {{= disciplina}}</div>
        {{if possui == false}}<a href="javascript:void(0);"><img style="margin-left:120px;margin-top:-20px" border="0" src="/media/img/btn_comprar.jpg" class="btn_comprar" atleta_id="{{= atleta_id}}"></a>{{/if}}
      </div>
      <div class="sponsorData">NADA AINDA</div>
    </div>
</script>    
    
</%def>

